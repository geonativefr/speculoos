(function(o,a){typeof exports=="object"&&typeof module!="undefined"?a(exports,require("vue"),require("clone-deep"),require("md5"),require("is-empty"),require("vue-router"),require("psr7-js"),require("uuid"),require("mitt"),require("uri-templates"),require("@vueuse/core")):typeof define=="function"&&define.amd?define(["exports","vue","clone-deep","md5","is-empty","vue-router","psr7-js","uuid","mitt","uri-templates","@vueuse/core"],a):(o=typeof globalThis!="undefined"?globalThis:o||self,a(o.Speculoos={},o.Vue,o.clone$1,o.md5,o.empty,o.vueRouter,o.psr7Js,o.uuid,o.mitt,o.uriTemplate,o.core))})(this,function(o,a,W,Bt,Jt,ct,tt,Wt,Gt,Kt,Xt){"use strict";var Le=Object.defineProperty;var Ne=(o,a,W)=>a in o?Le(o,a,{enumerable:!0,configurable:!0,writable:!0,value:W}):o[a]=W;var y=(o,a,W)=>(Ne(o,typeof a!="symbol"?a+"":a,W),W);function et(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var $t=et(W),te=et(Bt),k=et(Jt),ee=et(Gt),re=et(Kt);class vt extends Error{constructor(e){super(e.statusText),this.response=e,this.statusCode=parseInt(this.response.status)}isStatusCode(e){const t=r=>parseInt(r)===this.statusCode;for(let r of arguments)if(t(r))return!0;return!1}isClientError(){return this.statusCode>=400&&this.statusCode<500}isServerError(){return this.statusCode>500}static guard(e){if(e.status>=400)throw new this(e);return e}}const ft=n=>{if(!(n instanceof Headers))return n;const e={};for(let t of n.keys())e[t]=n.get(t);return e},ne={Accept:"application/ld+json, application/json"},bt=async n=>{try{const e=await n.text();try{n.data=JSON.parse(e),n.json=()=>new Promise(t=>t(n.data))}catch{n.data=e,n.json=()=>new Promise(r=>r(n.data))}}catch{}return n};class ie{constructor({baseUri:e="",options:t={},fetcher:r=window.fetch.bind(window)}={}){y(this,"baseUri");y(this,"options");y(this,"fetch");this.baseUri=e,this.options=t,this.fetch=async(i,s)=>r(i,s).then(bt)}resolve(e){return new URL(e,this.baseUri).toString()}mergeOptions(e){let t={...this.options};Object.keys(t).includes("headers")&&(t.headers=ft(t.headers));for(let r of arguments){let i={...r};Object.keys(i).includes("headers")&&(i.headers={...ft(i.headers)}),t={...$t.default(t),...$t.default(i)}}return t}async request(e,t,r){t=`${a.unref(t)}`,r=this.mergeOptions({method:e},r),Object.keys(r).includes("headers")&&(r.headers=new Headers({...ne,...ft(r.headers)}));try{a.isRef(r==null?void 0:r.isLoading)&&(r.isLoading.value=!0);const i=await this.fetch(t,r);return vt.guard(i)}finally{a.isRef(r==null?void 0:r.isLoading)&&(r.isLoading.value=!1)}}async get(e,t={}){return await this.request("GET",this.resolve(e),this.mergeOptions(t))}async post(e,t,r={}){return await this.request("POST",this.resolve(e),this.mergeOptions({body:JSON.stringify(a.unref(t)),headers:{"Content-Type":"application/json"}},r))}async put(e,t,r={}){return await this.request("PUT",this.resolve(e),this.mergeOptions({body:JSON.stringify(a.unref(t)),headers:{"Content-Type":"application/json"}},r))}async delete(e,t={}){return await this.request("DELETE",this.resolve(e),this.mergeOptions(t))}}class se{constructor(e=window.fetch.bind(window)){y(this,"fetch");y(this,"pendingRequests",[]);return this.fetch=e,(t,r)=>{try{const i=te.default(JSON.stringify({url:t,...r})),s=this.pendingRequests.findIndex(m=>i===m.hash);if(s>=0)return this.pendingRequests[s].promise;const h=this.fetch(t,r).then(bt);return this.pendingRequests.push({hash:i,promise:h}),h.then(m=>(this.removePendingRequest(i),m),m=>{throw this.removePendingRequest(i),m})}catch{return this.fetch(t,r)}}}removePendingRequest(e){const t=this.pendingRequests.findIndex(r=>e===r.hash);t>=0&&this.pendingRequests.splice(t,1)}}function ae(n=void 0){return new se(n)}const G=(n,e=!0,t=[])=>{if(typeof n!="object"||n==null)return n;const r=t.find(s=>s.orig===n);if(r!=null)return r.cloned;let i=Object.assign(Object.create(Object.getPrototypeOf(n)),n);if(Array.isArray(n)&&(i=Object.values(i)),t.push({orig:n,cloned:i}),e)for(const s in i)typeof i[s]=="object"&&i[s]!=null&&(i[s]=G(i[s],e,t));return"__clone"in i&&typeof i.__clone=="function"&&i.__clone(),i};class x{normalize(){throw Error("This method is meant to be overriden.")}async denormalize(e){throw Error("This method is meant to be overriden.")}}class oe extends x{constructor(t=[]){super();y(this,"values");this.values=t}normalize(){return this.values}async denormalize(t){if(typeof t=="string"&&(t=t.trim()),[void 0,null,""].includes(t)){this.values=[];return}Array.isArray(t)||(t=[t]),this.values=t}}var lt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},wt={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(lt,function(){var t=1e3,r=6e4,i=36e5,s="millisecond",h="second",m="minute",d="hour",b="day",A="week",_="month",O="quarter",I="year",D="date",f="Invalid Date",T=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,R=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},E=function(v,l,u){var g=String(v);return!g||g.length>=l?v:""+Array(l+1-g.length).join(u)+v},N={s:E,z:function(v){var l=-v.utcOffset(),u=Math.abs(l),g=Math.floor(u/60),c=u%60;return(l<=0?"+":"-")+E(g,2,"0")+":"+E(c,2,"0")},m:function v(l,u){if(l.date()<u.date())return-v(u,l);var g=12*(u.year()-l.year())+(u.month()-l.month()),c=l.clone().add(g,_),$=u-c<0,p=l.clone().add(g+($?-1:1),_);return+(-(g+(u-c)/($?c-p:p-c))||0)},a:function(v){return v<0?Math.ceil(v)||0:Math.floor(v)},p:function(v){return{M:_,y:I,w:A,d:b,D,h:d,m,s:h,ms:s,Q:O}[v]||String(v||"").toLowerCase().replace(/s$/,"")},u:function(v){return v===void 0}},j="en",P={};P[j]=M;var F=function(v){return v instanceof Q},V=function v(l,u,g){var c;if(!l)return j;if(typeof l=="string"){var $=l.toLowerCase();P[$]&&(c=$),u&&(P[$]=u,c=$);var p=l.split("-");if(!c&&p.length>1)return v(p[0])}else{var S=l.name;P[S]=l,c=S}return!g&&c&&(j=c),c||!g&&j},z=function(v,l){if(F(v))return v.clone();var u=typeof l=="object"?l:{};return u.date=v,u.args=arguments,new Q(u)},w=N;w.l=V,w.i=F,w.w=function(v,l){return z(v,{locale:l.$L,utc:l.$u,x:l.$x,$offset:l.$offset})};var Q=function(){function v(u){this.$L=V(u.locale,null,!0),this.parse(u)}var l=v.prototype;return l.parse=function(u){this.$d=function(g){var c=g.date,$=g.utc;if(c===null)return new Date(NaN);if(w.u(c))return new Date;if(c instanceof Date)return new Date(c);if(typeof c=="string"&&!/Z$/i.test(c)){var p=c.match(T);if(p){var S=p[2]-1||0,Y=(p[7]||"0").substring(0,3);return $?new Date(Date.UTC(p[1],S,p[3]||1,p[4]||0,p[5]||0,p[6]||0,Y)):new Date(p[1],S,p[3]||1,p[4]||0,p[5]||0,p[6]||0,Y)}}return new Date(c)}(u),this.$x=u.x||{},this.init()},l.init=function(){var u=this.$d;this.$y=u.getFullYear(),this.$M=u.getMonth(),this.$D=u.getDate(),this.$W=u.getDay(),this.$H=u.getHours(),this.$m=u.getMinutes(),this.$s=u.getSeconds(),this.$ms=u.getMilliseconds()},l.$utils=function(){return w},l.isValid=function(){return this.$d.toString()!==f},l.isSame=function(u,g){var c=z(u);return this.startOf(g)<=c&&c<=this.endOf(g)},l.isAfter=function(u,g){return z(u)<this.startOf(g)},l.isBefore=function(u,g){return this.endOf(g)<z(u)},l.$g=function(u,g,c){return w.u(u)?this[g]:this.set(c,u)},l.unix=function(){return Math.floor(this.valueOf()/1e3)},l.valueOf=function(){return this.$d.getTime()},l.startOf=function(u,g){var c=this,$=!!w.u(g)||g,p=w.p(u),S=function(X,L){var J=w.w(c.$u?Date.UTC(c.$y,L,X):new Date(c.$y,L,X),c);return $?J:J.endOf(b)},Y=function(X,L){return w.w(c.toDate()[X].apply(c.toDate("s"),($?[0,0,0,0]:[23,59,59,999]).slice(L)),c)},C=this.$W,q=this.$M,B=this.$D,Z="set"+(this.$u?"UTC":"");switch(p){case I:return $?S(1,0):S(31,11);case _:return $?S(1,q):S(0,q+1);case A:var nt=this.$locale().weekStart||0,it=(C<nt?C+7:C)-nt;return S($?B-it:B+(6-it),q);case b:case D:return Y(Z+"Hours",0);case d:return Y(Z+"Minutes",1);case m:return Y(Z+"Seconds",2);case h:return Y(Z+"Milliseconds",3);default:return this.clone()}},l.endOf=function(u){return this.startOf(u,!1)},l.$set=function(u,g){var c,$=w.p(u),p="set"+(this.$u?"UTC":""),S=(c={},c[b]=p+"Date",c[D]=p+"Date",c[_]=p+"Month",c[I]=p+"FullYear",c[d]=p+"Hours",c[m]=p+"Minutes",c[h]=p+"Seconds",c[s]=p+"Milliseconds",c)[$],Y=$===b?this.$D+(g-this.$W):g;if($===_||$===I){var C=this.clone().set(D,1);C.$d[S](Y),C.init(),this.$d=C.set(D,Math.min(this.$D,C.daysInMonth())).$d}else S&&this.$d[S](Y);return this.init(),this},l.set=function(u,g){return this.clone().$set(u,g)},l.get=function(u){return this[w.p(u)]()},l.add=function(u,g){var c,$=this;u=Number(u);var p=w.p(g),S=function(q){var B=z($);return w.w(B.date(B.date()+Math.round(q*u)),$)};if(p===_)return this.set(_,this.$M+u);if(p===I)return this.set(I,this.$y+u);if(p===b)return S(1);if(p===A)return S(7);var Y=(c={},c[m]=r,c[d]=i,c[h]=t,c)[p]||1,C=this.$d.getTime()+u*Y;return w.w(C,this)},l.subtract=function(u,g){return this.add(-1*u,g)},l.format=function(u){var g=this,c=this.$locale();if(!this.isValid())return c.invalidDate||f;var $=u||"YYYY-MM-DDTHH:mm:ssZ",p=w.z(this),S=this.$H,Y=this.$m,C=this.$M,q=c.weekdays,B=c.months,Z=function(L,J,pt,ut){return L&&(L[J]||L(g,$))||pt[J].slice(0,ut)},nt=function(L){return w.s(S%12||12,L,"0")},it=c.meridiem||function(L,J,pt){var ut=L<12?"AM":"PM";return pt?ut.toLowerCase():ut},X={YY:String(this.$y).slice(-2),YYYY:this.$y,M:C+1,MM:w.s(C+1,2,"0"),MMM:Z(c.monthsShort,C,B,3),MMMM:Z(B,C),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:Z(c.weekdaysMin,this.$W,q,2),ddd:Z(c.weekdaysShort,this.$W,q,3),dddd:q[this.$W],H:String(S),HH:w.s(S,2,"0"),h:nt(1),hh:nt(2),a:it(S,Y,!0),A:it(S,Y,!1),m:String(Y),mm:w.s(Y,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:p};return $.replace(R,function(L,J){return J||X[L]||p.replace(":","")})},l.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},l.diff=function(u,g,c){var $,p=w.p(g),S=z(u),Y=(S.utcOffset()-this.utcOffset())*r,C=this-S,q=w.m(this,S);return q=($={},$[I]=q/12,$[_]=q,$[O]=q/3,$[A]=(C-Y)/6048e5,$[b]=(C-Y)/864e5,$[d]=C/i,$[m]=C/r,$[h]=C/t,$)[p]||C,c?q:w.a(q)},l.daysInMonth=function(){return this.endOf(_).$D},l.$locale=function(){return P[this.$L]},l.locale=function(u,g){if(!u)return this.$L;var c=this.clone(),$=V(u,g,!0);return $&&(c.$L=$),c},l.clone=function(){return w.w(this.$d,this)},l.toDate=function(){return new Date(this.valueOf())},l.toJSON=function(){return this.isValid()?this.toISOString():null},l.toISOString=function(){return this.$d.toISOString()},l.toString=function(){return this.$d.toUTCString()},v}(),Qt=Q.prototype;return z.prototype=Qt,[["$ms",s],["$s",h],["$m",m],["$H",d],["$W",b],["$M",_],["$y",I],["$D",D]].forEach(function(v){Qt[v[1]]=function(l){return this.$g(l,v[0],v[1])}}),z.extend=function(v,l){return v.$i||(v(l,Q,z),v.$i=!0),z},z.locale=V,z.isDayjs=F,z.unix=function(v){return z(1e3*v)},z.en=P[j],z.Ls=P,z.p={},z})})(wt);var H=wt.exports,St={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(lt,function(){var t="minute",r=/[+-]\d\d(?::?\d\d)?/g,i=/([+-]|\d\d)/g;return function(s,h,m){var d=h.prototype;m.utc=function(f){var T={date:f,utc:!0,args:arguments};return new h(T)},d.utc=function(f){var T=m(this.toDate(),{locale:this.$L,utc:!0});return f?T.add(this.utcOffset(),t):T},d.local=function(){return m(this.toDate(),{locale:this.$L,utc:!1})};var b=d.parse;d.parse=function(f){f.utc&&(this.$u=!0),this.$utils().u(f.$offset)||(this.$offset=f.$offset),b.call(this,f)};var A=d.init;d.init=function(){if(this.$u){var f=this.$d;this.$y=f.getUTCFullYear(),this.$M=f.getUTCMonth(),this.$D=f.getUTCDate(),this.$W=f.getUTCDay(),this.$H=f.getUTCHours(),this.$m=f.getUTCMinutes(),this.$s=f.getUTCSeconds(),this.$ms=f.getUTCMilliseconds()}else A.call(this)};var _=d.utcOffset;d.utcOffset=function(f,T){var R=this.$utils().u;if(R(f))return this.$u?0:R(this.$offset)?_.call(this):this.$offset;if(typeof f=="string"&&(f=function(j){j===void 0&&(j="");var P=j.match(r);if(!P)return null;var F=(""+P[0]).match(i)||["-",0,0],V=F[0],z=60*+F[1]+ +F[2];return z===0?0:V==="+"?z:-z}(f),f===null))return this;var M=Math.abs(f)<=16?60*f:f,E=this;if(T)return E.$offset=M,E.$u=f===0,E;if(f!==0){var N=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(E=this.local().add(M+N,t)).$offset=M,E.$x.$localOffset=N}else E=this.utc();return E};var O=d.format;d.format=function(f){var T=f||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return O.call(this,T)},d.valueOf=function(){var f=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*f},d.isUTC=function(){return!!this.$u},d.toISOString=function(){return this.toDate().toISOString()},d.toString=function(){return this.toDate().toUTCString()};var I=d.toDate;d.toDate=function(f){return f==="s"&&this.$offset?m(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():I.call(this)};var D=d.diff;d.diff=function(f,T,R){if(f&&this.$u===f.$u)return D.call(this,f,T,R);var M=this.local(),E=m(f).local();return D.call(M,E,T,R)}}})})(St);var Tt=St.exports,zt={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(lt,function(){var t={year:0,month:1,day:2,hour:3,minute:4,second:5},r={};return function(i,s,h){var m,d=function(O,I,D){D===void 0&&(D={});var f=new Date(O),T=function(R,M){M===void 0&&(M={});var E=M.timeZoneName||"short",N=R+"|"+E,j=r[N];return j||(j=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:R,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:E}),r[N]=j),j}(I,D);return T.formatToParts(f)},b=function(O,I){for(var D=d(O,I),f=[],T=0;T<D.length;T+=1){var R=D[T],M=R.type,E=R.value,N=t[M];N>=0&&(f[N]=parseInt(E,10))}var j=f[3],P=j===24?0:j,F=f[0]+"-"+f[1]+"-"+f[2]+" "+P+":"+f[4]+":"+f[5]+":000",V=+O;return(h.utc(F).valueOf()-(V-=V%1e3))/6e4},A=s.prototype;A.tz=function(O,I){O===void 0&&(O=m);var D=this.utcOffset(),f=this.toDate(),T=f.toLocaleString("en-US",{timeZone:O}),R=Math.round((f-new Date(T))/1e3/60),M=h(T).$set("millisecond",this.$ms).utcOffset(15*-Math.round(f.getTimezoneOffset()/15)-R,!0);if(I){var E=M.utcOffset();M=M.add(D-E,"minute")}return M.$x.$timezone=O,M},A.offsetName=function(O){var I=this.$x.$timezone||h.tz.guess(),D=d(this.valueOf(),I,{timeZoneName:O}).find(function(f){return f.type.toLowerCase()==="timezonename"});return D&&D.value};var _=A.startOf;A.startOf=function(O,I){if(!this.$x||!this.$x.$timezone)return _.call(this,O,I);var D=h(this.format("YYYY-MM-DD HH:mm:ss:SSS"));return _.call(D,O,I).tz(this.$x.$timezone,!0)},h.tz=function(O,I,D){var f=D&&I,T=D||I||m,R=b(+h(),T);if(typeof O!="string")return h(O).tz(T);var M=function(P,F,V){var z=P-60*F*1e3,w=b(z,V);if(F===w)return[z,F];var Q=b(z-=60*(w-F)*1e3,V);return w===Q?[z,w]:[P-60*Math.min(w,Q)*1e3,Math.max(w,Q)]}(h.utc(O,f).valueOf(),R,T),E=M[0],N=M[1],j=h(E).utcOffset(N);return j.$x.$timezone=T,j},h.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},h.tz.setDefault=function(O){m=O}}})})(zt);var Dt=zt.exports;H.extend(Tt),H.extend(Dt);class Ot extends x{constructor({after:t=null,before:r=null}={},{withTime:i=!0,useUserTimezone:s=!0}={}){super();y(this,"after");y(this,"before");y(this,"normalizedFormat");y(this,"useUserTimezone");this.after=t,this.before=r,this.normalizedFormat=i?"YYYY-MM-DD[T]HH:mm:ss[Z]":"YYYY-MM-DD",this.useUserTimezone=s}normalize(){this.constructor.ensureTimezoneIsSet();const t=this.useUserTimezone?this.constructor.userTimezone:"UTC";let r=null,i=null;return k.default(this.after)||(r=H.tz(this.after,t).hour(0).minute(0).second(0).tz("UTC").format(this.normalizedFormat)),k.default(this.before)||(i=H.tz(this.before,t).hour(0).minute(0).second(0).add(1,"day").subtract(1,"second").tz("UTC").format(this.normalizedFormat)),{after:r,before:i}}async denormalize(t){this.constructor.ensureTimezoneIsSet(),this.after=null,this.before=null,k.default(t.after)||(this.after=this.useUserTimezone?H.tz(t.after,"UTC").tz(this.constructor.userTimezone):H.tz(t.after,"UTC"),this.after=this.after.hour(0).minute(0).second(0).format("YYYY-MM-DD")),k.default(t.before)||(this.before=this.useUserTimezone?H.tz(t.before,"UTC").tz(this.constructor.userTimezone):H.tz(t.before,"UTC"),this.before=this.before.hour(0).minute(0).second(0).add(1,"day").subtract(1,"second").format("YYYY-MM-DD"))}static ensureTimezoneIsSet(){var t;this.constructor.userTimezone=(t=this.constructor.userTimezone)!=null?t:H.tz.guess()||"UTC"}}y(Ot,"userTimezone"),H.extend(Tt),H.extend(Dt);class It extends x{constructor({after:t=null,before:r=null}={}){super();y(this,"after");y(this,"before");this.after=t,this.before=r}normalize(){this.constructor.ensureTimezoneIsSet();let t=null,r=null;return k.default(this.after)||(t=H.tz(this.after,this.constructor.userTimezone).tz("UTC").format("YYYY-MM-DD[T]HH:mm:ss[Z]")),k.default(this.before)||(r=H.tz(this.before,this.constructor.userTimezone).tz("UTC").format("YYYY-MM-DD[T]HH:mm:ss[Z]")),{after:t,before:r}}async denormalize(t){this.constructor.ensureTimezoneIsSet(),this.after=null,this.before=null,k.default(t.after)||(this.after=H.tz(t.after,"UTC").tz(this.constructor.userTimezone).format("YYYY-MM-DD[T]HH:mm:ss[Z]")),k.default(t.before)||(this.before=H.tz(t.before,"UTC").tz(this.constructor.userTimezone).format("YYYY-MM-DD[T]HH:mm:ss[Z]"))}static ensureTimezoneIsSet(){var t;this.constructor.userTimezone=(t=this.constructor.userTimezone)!=null?t:H.tz.guess()||"UTC"}}y(It,"userTimezone");function ue(n){return n==null?!0:typeof n=="string"?n.trim().length===0:typeof n=="function"||Array.isArray(n)?n.length===0:n instanceof Object?Object.keys(n).length===0:!1}function ht(n){if(!(n instanceof Object))return n;if(Array.isArray(n))return n.map(ht);const e={...n};return Object.keys(e).forEach(t=>{e[t]instanceof Object&&(e[t]=ht(e[t])),ue(e[t])&&delete e[t]}),e}class ce{constructor(e={}){y(this,"_filters",[]);if(!(e instanceof Object))throw Error("A FilterCollection expects an object.");Object.keys(e).forEach(t=>{if(!(e[t]instanceof x))throw Error(`Filter ${t} doesn't extend the Filter class.`);this[t]=e[t],this._filters.push(t)})}normalize(){const e={};return this._filters.forEach(t=>{const r=this[t];e[t]=r.normalize()}),ht(e)}async denormalize(e){const t=[];for(const r of this._filters){const i=this[r];i instanceof x&&typeof e[r]!="undefined"&&t.push(i.denormalize(e[r]))}return t.length>0&&await Promise.all(t),this}}async function fe(n={},e={preserveQuery:!1,targetRoute:void 0}){if(typeof n!="function")throw Error("initialState should be provided as a function.");const t=ct.useRoute(),r=ct.useRouter(),i=a.ref(n());async function s(b){Object.assign(a.unref(i),await a.unref(i).denormalize(b.query))}function h(){i.value=G(n())}function m(b={}){const A={};return e.preserveQuery===!0&&Object.assign(A,t.query),Object.assign(A,a.unref(i).normalize(),b)}async function d(b={}){var _;const A=(_=a.unref(e.targetRoute))!=null?_:t;await r.push(Object.assign({...A},{query:m(b)}))}return ct.onBeforeRouteUpdate(b=>s(b)),await s(t),{filters:i,buildQueryParams:m,submit:d,clear:h}}const le=async({state:n={},methods:e={},name:t="store"}={})=>{n=a.reactive(n);const r={name:t,state:n,...Object.keys(e).reduce(function(i,s){const h=e[s];return i[s]=function(){return h(n,...arguments)},i},{}),async use(i){return await i.install(this),this}};return r.install=i=>i.provide(t,{...r,state:a.readonly(n)}),r},dt=(n="store")=>a.inject(n);class Mt{constructor(e){Object.keys(e).forEach(t=>{this[t]=new st(e[t])})}for(e){if(typeof e=="string"&&Object.keys(this).includes(e))return this[e];if(!Object.keys(this).includes(e["@type"]))throw Error(`Endpoint not found for item ${e["@type"]}.`);return this[e["@type"]]}}class st{constructor(e){y(this,"endpoint");this.endpoint=e}toString(){return this.endpoint}toJSON(){return this.endpoint}buildIri(e){let t=new tt.URI(this.endpoint);return t=t.withPath(`${t.getPath()}/${e}`),t.toString()}withQuery(e){const t=new tt.URI(this.endpoint),r=new tt.QueryString(t).withParams(e);return new st(t.withQuery(r.toString()).toString())}paginated(e,t=!1){if(e=a.unref(e),e===!1)return this.withQuery({pagination:0});const r={pagination:1};return e&&(r.itemsPerPage=e),a.unref(t)===!0&&(r.partial=1),this.withQuery(r)}synchronize(e=window.location.href){return this.withQuery(new tt.QueryString(new tt.URI(e)).getParams())}}const he=(n,e)=>dt(e).state.endpoints[n];function rt(n){return n=a.unref(n),n==null?!1:Object.keys(n).includes("@id")&&n["@id"]!=null}function U(n){return n=a.unref(n),n===null?null:typeof n=="string"?n:(at(n),n["@id"])}function Et(n){const e=U(n);return e.substring(e.lastIndexOf("/")+1)}function de(n){return n.map(U)}function me(n){return n.map(Et)}function at(n,e=null){if(typeof n!="object"||!("@id"in n))throw Error("Invalid item.");if(e!==null){if(typeof e=="string"&&e!==n["@type"])throw Error(`Expected item of type "${e}", got "${n["@type"]}".`);if(Array.isArray(e)&&e.includes(n["@type"])===!1)throw Error(`Expected item of any "${e.join("|")}", got "${n["@type"]}".`)}}function K(n,e){return U(n)===U(e)}function Ct(n,e){if(n=a.unref(n),n=Array.from(n).map(a.unref),e=a.unref(e),Array.isArray(e)){const t=e;for(const r of t)if(Ct(n,r))return!0;return!1}for(const t of n)if(K(t,e))return!0;return!1}function ye(n,e){const t=n.findIndex(r=>K(r,e));return t>=0&&n.splice(t,1),n}function ot(n,e){const t=n.find(r=>K(r,e));return typeof t=="undefined"?null:t}function ge(n,e){return n.findIndex(t=>K(t,e))}function pe(n,e){return n.filter(t=>t["@type"]===e)}function $e(n){Object.assign(n,n.map(e=>U(e)))}function ve(n,e){return n=a.unref(n),at(n),Object.assign({"@id":n["@id"],"@type":n["@type"]},e)}class mt extends Error{constructor(){super(...arguments);y(this,"statusCode")}get title(){return this["hydra:title"]}get description(){return this["hydra:description"]}}class At{constructor(){y(this,"id");y(this,"propertyPath");y(this,"message");y(this,"code");this.id=Wt.v4()}}class jt extends mt{constructor(t){super();y(this,"_violations",[]);Object.assign(this,{*[Symbol.iterator](){yield*this.violations}}),Object.assign(this,t)}get violations(){return this._violations}set violations(t){this._violations=t.map(r=>Object.assign(new At,r))}getPropertyPaths(){return[...new Set(this.violations.map(({propertyPath:t})=>t))]}getViolations(t){const r=Array.from(arguments);return r.length===0?this.violations:k.default(r[0])?this.violations.filter(i=>k.default(i.propertyPath)):this.violations.filter(i=>t===i.propertyPath)}}class Yt{constructor(e={}){Object.assign(this,{...e,*[Symbol.iterator](){yield*this["hydra:member"]||[]}})}get length(){return this.items.length}get totalItems(){return this["hydra:totalItems"]||0}get items(){return this["hydra:member"]||[]}forEach(e){return(this["hydra:member"]||[]).forEach(e)}map(e){return(this["hydra:member"]||[]).map(e)}filter(e){return(this["hydra:member"]||[]).filter(e)}find(e){return(this["hydra:member"]||[]).find(e)}findIndex(e){return(this["hydra:member"]||[]).findIndex(e)}}function be(n){if(typeof n!="object"||n==null)throw Error("Invalid object.");return Object.keys(n).forEach(e=>delete n[e]),n}function _t(n){return rt(n)?U(n):n}function Ut(n){const e=G(n),t=Object.keys(e);for(const r of t){const i=e[r];Array.isArray(i)?e[r]=i.map(s=>_t(s)):typeof i=="object"&&i!=null&&(e[r]=_t(i))}return e}function yt(n,e){return n=be(n),Object.assign(n,e)}function we(n){const e=dt(),t=a.ref(a.unref(n)),r=a.reactive(G(a.unref(n))),i=a.computed(()=>!rt(a.unref(r))),s=a.ref(!1);a.watch(t,b=>yt(r,b));const h=a.computed(()=>JSON.stringify(a.unref(r))!==JSON.stringify(a.unref(t)));return{item:r,isUnsavedDraft:h,isCreationMode:i,isSubmitting:s,reset:b=>yt(r,G(a.unref(b!=null?b:n))),submit:async b=>{a.isRef(b)&&(b=a.unref(b));try{s.value=!0;const A=await e.upsertItem(Ut(b!=null?b:r));return t.value=A,yt(r,G(A)),A}finally{s.value=!1}}}}function Se(){const n=i=>{i=a.unref(i),i.querySelectorAll("[name]").forEach(function(s){s.setCustomValidity("")})},e=(i,s=!0)=>{i=a.unref(i);const h=i.checkValidity();return!h&&s&&i.reportValidity(),h},t=(i,s)=>{n(i),Array.from(s).forEach(h=>r(i,h)),e(i)},r=(i,{propertyPath:s,message:h})=>{var m;i=a.unref(i),(m=i.querySelector(`[name='${s}']`))==null||m.setCustomValidity(h)};return{resetValidity:n,bindViolations:t,validate:e}}let gt;const Te=1,ze=2;class Rt{constructor(e,t){y(this,"readyState",Te);y(this,"url");y(this,"withCredentials");var r;this.url=e,this.withCredentials=(r=t==null?void 0:t.withCredentials)!=null?r:!1,setTimeout(()=>this.onopen(),10)}onerror(){}onmessage(){}onopen(){}close(){this.readyState=ze}triggerEvent(e){this.onmessage(e)}triggerError(e){this.onerror(e)}}(()=>{var n;return typeof process!="undefined"&&((n=process==null?void 0:process.env)==null?void 0:n.NODE_ENV)==="test"||"test"===void 0})()?gt=Rt:gt=window.EventSource;var De=gt;const Oe=(n,e)=>{const t=new qt(n,e);return Object.assign(t,{install(r){r.provide("mercure",t)}})},Ht=()=>a.inject("mercure");function Ie(n,e){return n.length===e.length&&n.every(t=>e.includes(t))}class qt{constructor(e,t={}){y(this,"hub");y(this,"options");y(this,"connection");y(this,"subscribedTopics");y(this,"endpoint");y(this,"emitter");y(this,"lastEventId");Object.assign(this,{hub:e,options:a.reactive(t)}),this.lastEventId=a.ref(),this.subscribedTopics=a.ref([]),this.endpoint=a.computed(()=>{const r=new URL(this.hub),i=a.unref(this.subscribedTopics);return i.includes("*")?r.searchParams.append("topic","*"):i.forEach(s=>r.searchParams.append("topic",s)),a.unref(this.lastEventId)&&r.searchParams.append("Last-Event-ID",a.unref(this.lastEventId)),r.toString()}),this.emitter=ee.default()}subscribe(e=["*"],t=!0){Array.isArray(e)||(e=[e]);const r=Array.from(a.unref(this.subscribedTopics)),i=[...new Set([...a.unref(this.subscribedTopics),...e])];this.subscribedTopics.value=i,t&&!Ie(r,i)&&this.listen()}unsubscribe(e){Array.isArray(e)||(e=[e]),this.subscribedTopics.value=this.subscribedTopics.value.filter(t=>!e.includes(t)),this.connection&&this.listen()}addListener(e){return this.emitter.on("message",e)}removeListener(e){return this.emitter.off("message",e)}listen(){if(a.unref(this.subscribedTopics).length===0){this.stop();return}this.connection||this.connect()}connect(){this.stop(),this.connection=new De(a.unref(this.endpoint),this.options),this.connection.onopen=()=>this.emitter.emit("open",{endpoint:a.unref(this.endpoint)}),this.connection.onmessage=e=>(this.lastEventId.value=e.lastEventId,this.emitter.emit("message",e)),this.connection.onerror=e=>{this.emitter.emit("error",e),typeof this.options.reconnectInterval=="number"&&(this.stop(),setTimeout(()=>this.connect(),this.options.reconnectInterval))}}stop(){var e;(e=this.connection)==null||e.close(),this.connection=void 0}}const Pt=(n,e)=>Object.assign(e,n),Ft=()=>{};function Lt(n,e,t=["*"],r=Pt,i=Ft){Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]);const s=h=>{try{const m=JSON.parse(h.data);if(!rt(m))return;if(Object.keys(m).length===1){i(U(m));return}for(const d of e)K(U(m),d)&&r(m,a.unref(d))}catch(m){console.debug(m)}};return n.addListener(s),n.subscribe(t),s}const Nt=(n,e,t)=>{Array.isArray(e)||(e=[e]);const r=i=>{try{const s=JSON.parse(i.data);for(const h of e)if(typeof re.default(h).fromUri(U(s))!="undefined"){t(s);break}}catch{}};return n.addListener(r),n.subscribe(e),r},Me=n=>{n=n!=null?n:Ht();const e=[];return a.onUnmounted(()=>{for(const r of e)n.removeListener(r)}),{synchronize:(r,i=["*"],s=Pt,h=Ft)=>{e.push(Lt(n,r,i,s,h))},on(r,i){const s=Nt(n,r,i);return e.push(s),s}}},Ee={"hydra:Collection":Yt,"hydra:Error":mt,ConstraintViolationList:jt},Vt=async(n,e)=>{const t=a.ref(!1),r=Xt.asyncComputed(n,e,{evaluating:t});return new Promise(i=>{a.watch(t,s=>{s===!1&&i(r)})})};class kt{constructor(){Object.assign(this,{*[Symbol.iterator](){yield*Object.values(this)}})}get length(){return Array.from(this).length}forEach(e){return Array.from(this).forEach(e)}map(e){return Array.from(this).map(e)}filter(e){return Array.from(this).filter(e)}find(e){return Array.from(this).find(e)}findIndex(e){return Array.from(this).findIndex(e)}}const Ce=function(n){throw n};class Ae{constructor(e,t={}){y(this,"api");y(this,"endpoints");y(this,"classmap");var s;this.api=e;const{endpoints:r,classmap:i}=t;this.endpoints=new Mt(r!=null?r:{}),this.classmap={...Ee,...i},this.errorHandler=(s=t.errorHandler)!=null?s:Ce}factory(e,t){var r;for(const i in this.classmap)if(i===((r=e["@type"])!=null?r:e)){const s=this.classmap[i];return e instanceof s?e:(e=Object.assign(new s,e),t&&Object.assign(e,{statusCode:t}),a.reactive(e))}return e}storeItem({state:e},t){const r=U(t);return Object.keys(e.items).includes(r)?Object.assign(e.items[r],t):e.items[r]=a.ref(t),e.items[r]}removeItem({state:e},t){const r=U(t);delete e.items[r]}async clearItems({state:e}){e.items=a.reactive(new kt)}async handle(e,{errorHandler:t=this.errorHandler}={}){var r,i,s,h,m;try{const{data:d}=await e();return this.factory(d)}catch(d){typeof((r=d.response)==null?void 0:r.data)=="object"&&((i=d.response)==null?void 0:i.data)!=null&&(d=this.factory(d.response.data,(s=d.response)==null?void 0:s.status)),d.statusCode=(m=d.statusCode)!=null?m:(h=d.response)==null?void 0:h.status,t(d)}}async fetchItem({state:e},t,r){const i=U(t),s=await this.handle(()=>this.api.get(i,r),r);return this.storeItem({state:e},this.factory(s))}async getItem({state:e},t,r){if(t===null)return null;const i=U(t),s=ot(e.items,i);return s!=null?s:await this.fetchItem({state:e},i,r)}async fetchCollection({state:e},t,r){const i=await this.handle(()=>this.api.get(t,r),r);i["hydra:member"]=i["hydra:member"].map(h=>this.factory(h));const s=this.factory(i);return s["hydra:member"]=s["hydra:member"].map(h=>this.factory(h)),s}async createItem({state:e},t,r){const i=this.endpoints.for(t);return t=await this.handle(()=>this.api.post(i,t,r),r),this.storeItem({state:e},t)}async updateItem({state:e},t,r){return at(t),t=await this.handle(()=>this.api.put(U(t),t,r),r),this.storeItem({state:e},t)}async upsertItem({state:e},t,r){return rt(t)?this.updateItem({state:e},t,r):this.createItem({state:e},t,r)}async deleteItem({state:e},t,r){const i=U(t);await this.handle(()=>this.api.delete(i,r),r),t=ot(e.items,i),t!==null&&this.removeItem({state:e},t)}async getRelation({state:e},t,r={}){var i,s;if(t===null)return null;if(typeof t=="function")return Vt(()=>this.getRelation({state:e},t(),r));if(((i=r.useExisting)!=null?i:!0)===!0){const h=ot(e.items,t);if(h!=null)return h}return typeof t=="object"&&((s=r.force)!=null?s:!1)===!1?t:await this.getItem({state:e},t,r)}async getRelations({state:e},t,r){return typeof t=="function"?Vt(()=>this.getRelations({state:e},t(),r),[]):Promise.all(t.map(i=>this.getRelation({state:e},i,r)))}async install(e){e.state.items=a.reactive(new kt),e.state.endpoints=a.readonly(this.endpoints),e.state.classmap=a.readonly(this.classmap),e.storeItem=t=>this.storeItem(e,t),e.removeItem=t=>this.removeItem(e,t),e.clearItems=()=>this.clearItems(e),e.getItem=(t,r)=>this.getItem(e,t,r),e.fetchItem=(t,r)=>this.fetchItem(e,t,r),e.fetchCollection=(t,r)=>this.fetchCollection(e,t,r),e.createItem=(t,r)=>this.createItem(e,t,r),e.updateItem=(t,r)=>this.updateItem(e,t,r),e.upsertItem=(t,r)=>this.upsertItem(e,t,r),e.deleteItem=(t,r)=>this.deleteItem(e,t,r),e.getRelation=(t,r)=>this.getRelation(e,t,r),e.getRelations=(t,r)=>this.getRelations(e,t,r),e.endpoint=t=>e.state.endpoints[t],e.getItemsByType=t=>e.state.items.filter(r=>t===r["@type"]),e.factory=(t,r)=>(r=r!=null?r:t,typeof t=="string"&&(r["@type"]=t),this.factory(r))}}function xt(n){if(typeof n=="string")return n;try{return U(n)}catch{return null}}function je(n){return n.map(e=>xt(e))}async function Zt(n,e){try{return await e.getItem(n)}catch{return null}}async function Ye(n,e){return Promise.all(n.map(t=>Zt(t,e)))}class _e extends x{constructor(t,{store:r,multiple:i=!1}){super();y(this,"items",[]);y(this,"multiple");y(this,"store");this.items=Array.isArray(t)?t:[t],this.store=r,this.multiple=i}get item(){var t;return(t=this.items[0])!=null?t:null}set item(t){this.items=[t],this.multiple=!1}normalize(){return this.multiple||this.items.length>1?je(this.items):xt(this.item)}async denormalize(t){if(Array.isArray(t)){this.items=await Ye(t,this.store);return}this.items=[await Zt(t,this.store)]}}const Ue={asc:"desc",desc:"asc"};class Re extends x{constructor(t={}){super();y(this,"order");this.order=t}revert(){var r;const t={};for(const i in this.order){const s=this.order[i];t[i]=(r=Ue[s])!=null?r:s}return this.order=t,this}normalize(){return this.order}async denormalize(t){this.order={},typeof t=="object"&&t!=null&&(this.order=t)}}class He extends x{constructor(t=null){super();y(this,"_value");this.value=t}get value(){return this._value}set value(t){this._value=t&&t.toString()}normalize(){var t;return[void 0,null,""].includes((t=this.value)==null?void 0:t.trim())?null:this.value.trim()}async denormalize(t){if(typeof t=="string"&&(t=t.trim()),[void 0,null,""].includes(t)){this.value=null;return}this.value=t}}class qe extends x{constructor(t=null){super();y(this,"value");this.value=t}normalize(){return this.value==null?null:this.value?"true":"false"}async denormalize(t){if(t==null){this.value=null;return}t=`${t}`.trim(),this.value=["true","on","yes","1"].includes(t.toLowerCase())}}class Pe{constructor(){y(this,"fields");y(this,"preload")}get headers(){var t,r,i,s,h;const e={};return((r=(t=this.preload)==null?void 0:t.length)!=null?r:0)!==0&&(e.preload=[...new Set(this.preload)].map(m=>`"${m}"`).join(", ")),((s=(i=this.fields)==null?void 0:i.length)!=null?s:0)!==0&&(e.fields=[...new Set([...this.fields,...(h=this.preload)!=null?h:[]])].map(m=>`"${m}"`).join(", ")),e}}function Fe({fields:n,preload:e}={}){return Object.assign(new Pe,{fields:n},{preload:e}).headers}o.ApiClient=ie,o.ArrayFilter=oe,o.ConstraintViolationList=jt,o.DateRangeFilter=Ot,o.DatetimeRangeFilter=It,o.FakeEventSource=Rt,o.FilterCollection=ce,o.HttpError=vt,o.HydraCollection=Yt,o.HydraEndpoint=st,o.HydraEndpoints=Mt,o.HydraError=mt,o.HydraPlugin=Ae,o.ItemFilter=_e,o.Mercure=qt,o.OrderFilter=Re,o.TextFilter=He,o.TruthyFilter=qe,o.Violation=At,o.areSameIris=K,o.checkValidItem=at,o.clone=G,o.containsIri=Ct,o.createMercure=Oe,o.createStore=le,o.getId=Et,o.getIds=me,o.getIri=U,o.getIris=de,o.getItemByIri=ot,o.getItemIndexByIri=ge,o.getItemsByType=pe,o.hasIri=rt,o.mercureSync=Lt,o.normalizeIris=$e,o.normalizeItemRelations=Ut,o.on=Nt,o.partialItem=ve,o.useEndpoint=he,o.useFilters=fe,o.useFormValidation=Se,o.useItemForm=we,o.useMercure=Ht,o.useMercureSync=Me,o.useStore=dt,o.vulcain=Fe,o.withoutDuplicates=ae,o.withoutIri=ye,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
