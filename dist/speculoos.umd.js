(function(a,o){typeof exports=="object"&&typeof module!="undefined"?o(exports,require("vue"),require("clone-deep"),require("md5"),require("is-empty"),require("vue-router"),require("psr7-js"),require("uuid"),require("mitt"),require("uri-templates"),require("@vueuse/core")):typeof define=="function"&&define.amd?define(["exports","vue","clone-deep","md5","is-empty","vue-router","psr7-js","uuid","mitt","uri-templates","@vueuse/core"],o):(a=typeof globalThis!="undefined"?globalThis:a||self,o(a.Speculoos={},a.Vue,a.clone$1,a.md5,a.empty,a.vueRouter,a.psr7Js,a.uuid,a.mitt,a.uriTemplate,a.core))})(this,function(a,o,W,Zt,Qt,ut,tt,Bt,Jt,Wt,Gt){"use strict";var Pe=Object.defineProperty;var Le=(a,o,W)=>o in a?Pe(a,o,{enumerable:!0,configurable:!0,writable:!0,value:W}):a[o]=W;var g=(a,o,W)=>(Le(a,typeof o!="symbol"?o+"":o,W),W);function et(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var $t=et(W),Kt=et(Zt),k=et(Qt),Xt=et(Jt),te=et(Wt);class bt extends Error{constructor(t){super(t.statusText),this.response=t,this.statusCode=parseInt(this.response.status)}isStatusCode(t){const e=n=>parseInt(n)===this.statusCode;for(let n of arguments)if(e(n))return!0;return!1}isClientError(){return this.statusCode>=400&&this.statusCode<500}isServerError(){return this.statusCode>500}static guard(t){if(t.status>=400)throw new this(t);return t}}const ct=r=>{if(!(r instanceof Headers))return r;const t={};for(let e of r.keys())t[e]=r.get(e);return t},ee={Accept:"application/ld+json, application/json"},vt=async r=>{try{const t=await r.text();try{r.data=JSON.parse(t),r.json=()=>new Promise(e=>e(r.data))}catch{r.data=t,r.json=()=>new Promise(n=>n(r.data))}}catch{}return r};class re{constructor({baseUri:t="",options:e={},fetcher:n=window.fetch.bind(window)}={}){g(this,"baseUri");g(this,"options");g(this,"fetch");this.baseUri=t,this.options=e,this.fetch=async(i,s)=>n(i,s).then(vt)}resolve(t){return new URL(t,this.baseUri).toString()}mergeOptions(t){let e={...this.options};Object.keys(e).includes("headers")&&(e.headers=ct(e.headers));for(let n of arguments){let i={...n};Object.keys(i).includes("headers")&&(i.headers={...ct(i.headers)}),e={...$t.default(e),...$t.default(i)}}return e}async request(t,e,n){e=`${o.unref(e)}`,n=this.mergeOptions({method:t},n),Object.keys(n).includes("headers")&&(n.headers=new Headers({...ee,...ct(n.headers)}));try{o.isRef(n==null?void 0:n.isLoading)&&(n.isLoading.value=!0);const i=await this.fetch(e,n);return bt.guard(i)}finally{o.isRef(n==null?void 0:n.isLoading)&&(n.isLoading.value=!1)}}async get(t,e={}){return await this.request("GET",this.resolve(t),this.mergeOptions(e))}async post(t,e,n={}){return await this.request("POST",this.resolve(t),this.mergeOptions({body:JSON.stringify(o.unref(e)),headers:{"Content-Type":"application/json"}},n))}async put(t,e,n={}){return await this.request("PUT",this.resolve(t),this.mergeOptions({body:JSON.stringify(o.unref(e)),headers:{"Content-Type":"application/json"}},n))}async delete(t,e={}){return await this.request("DELETE",this.resolve(t),this.mergeOptions(e))}}class ne{constructor(t=window.fetch.bind(window)){g(this,"fetch");g(this,"pendingRequests",[]);return this.fetch=t,(e,n)=>{try{const i=Kt.default(JSON.stringify({url:e,...n})),s=this.pendingRequests.findIndex(m=>i===m.hash);if(s>=0)return this.pendingRequests[s].promise;const l=this.fetch(e,n).then(vt);return this.pendingRequests.push({hash:i,promise:l}),l.then(m=>(this.removePendingRequest(i),m),m=>{throw this.removePendingRequest(i),m})}catch{return this.fetch(e,n)}}}removePendingRequest(t){const e=this.pendingRequests.findIndex(n=>t===n.hash);e>=0&&this.pendingRequests.splice(e,1)}}function ie(r=void 0){return new ne(r)}const G=(r,t=!0,e=[])=>{if(typeof r!="object"||r==null)return r;const n=e.find(s=>s.orig===r);if(n!=null)return n.cloned;let i=Object.assign(Object.create(Object.getPrototypeOf(r)),r);if(Array.isArray(r)&&(i=Object.values(i)),e.push({orig:r,cloned:i}),t)for(const s in i)typeof i[s]=="object"&&i[s]!=null&&(i[s]=G(i[s],t,e));return"__clone"in i&&typeof i.__clone=="function"&&i.__clone(),i};class x{normalize(){throw Error("This method is meant to be overriden.")}async denormalize(t){throw Error("This method is meant to be overriden.")}}class se extends x{constructor(e=[]){super();g(this,"values");this.values=e}normalize(){return this.values}async denormalize(e){if(typeof e=="string"&&(e=e.trim()),[void 0,null,""].includes(e)){this.values=[];return}Array.isArray(e)||(e=[e]),this.values=e}}var ft=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},wt={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(ft,function(){var e=1e3,n=6e4,i=36e5,s="millisecond",l="second",m="minute",d="hour",w="day",H="week",Y="month",I="quarter",O="year",z="date",f="Invalid Date",T=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},E=function(b,h,u){var y=String(b);return!y||y.length>=h?b:""+Array(h+1-y.length).join(u)+b},V={s:E,z:function(b){var h=-b.utcOffset(),u=Math.abs(h),y=Math.floor(u/60),c=u%60;return(h<=0?"+":"-")+E(y,2,"0")+":"+E(c,2,"0")},m:function b(h,u){if(h.date()<u.date())return-b(u,h);var y=12*(u.year()-h.year())+(u.month()-h.month()),c=h.clone().add(y,Y),$=u-c<0,p=h.clone().add(y+($?-1:1),Y);return+(-(y+(u-c)/($?c-p:p-c))||0)},a:function(b){return b<0?Math.ceil(b)||0:Math.floor(b)},p:function(b){return{M:Y,y:O,w:H,d:w,D:z,h:d,m,s:l,ms:s,Q:I}[b]||String(b||"").toLowerCase().replace(/s$/,"")},u:function(b){return b===void 0}},C="en",q={};q[C]=M;var L=function(b){return b instanceof Q},F=function b(h,u,y){var c;if(!h)return C;if(typeof h=="string"){var $=h.toLowerCase();q[$]&&(c=$),u&&(q[$]=u,c=$);var p=h.split("-");if(!c&&p.length>1)return b(p[0])}else{var S=h.name;q[S]=h,c=S}return!y&&c&&(C=c),c||!y&&C},D=function(b,h){if(L(b))return b.clone();var u=typeof h=="object"?h:{};return u.date=b,u.args=arguments,new Q(u)},v=V;v.l=F,v.i=L,v.w=function(b,h){return D(b,{locale:h.$L,utc:h.$u,x:h.$x,$offset:h.$offset})};var Q=function(){function b(u){this.$L=F(u.locale,null,!0),this.parse(u)}var h=b.prototype;return h.parse=function(u){this.$d=function(y){var c=y.date,$=y.utc;if(c===null)return new Date(NaN);if(v.u(c))return new Date;if(c instanceof Date)return new Date(c);if(typeof c=="string"&&!/Z$/i.test(c)){var p=c.match(T);if(p){var S=p[2]-1||0,A=(p[7]||"0").substring(0,3);return $?new Date(Date.UTC(p[1],S,p[3]||1,p[4]||0,p[5]||0,p[6]||0,A)):new Date(p[1],S,p[3]||1,p[4]||0,p[5]||0,p[6]||0,A)}}return new Date(c)}(u),this.$x=u.x||{},this.init()},h.init=function(){var u=this.$d;this.$y=u.getFullYear(),this.$M=u.getMonth(),this.$D=u.getDate(),this.$W=u.getDay(),this.$H=u.getHours(),this.$m=u.getMinutes(),this.$s=u.getSeconds(),this.$ms=u.getMilliseconds()},h.$utils=function(){return v},h.isValid=function(){return this.$d.toString()!==f},h.isSame=function(u,y){var c=D(u);return this.startOf(y)<=c&&c<=this.endOf(y)},h.isAfter=function(u,y){return D(u)<this.startOf(y)},h.isBefore=function(u,y){return this.endOf(y)<D(u)},h.$g=function(u,y,c){return v.u(u)?this[y]:this.set(c,u)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(u,y){var c=this,$=!!v.u(y)||y,p=v.p(u),S=function(X,N){var J=v.w(c.$u?Date.UTC(c.$y,N,X):new Date(c.$y,N,X),c);return $?J:J.endOf(w)},A=function(X,N){return v.w(c.toDate()[X].apply(c.toDate("s"),($?[0,0,0,0]:[23,59,59,999]).slice(N)),c)},j=this.$W,R=this.$M,B=this.$D,Z="set"+(this.$u?"UTC":"");switch(p){case O:return $?S(1,0):S(31,11);case Y:return $?S(1,R):S(0,R+1);case H:var rt=this.$locale().weekStart||0,nt=(j<rt?j+7:j)-rt;return S($?B-nt:B+(6-nt),R);case w:case z:return A(Z+"Hours",0);case d:return A(Z+"Minutes",1);case m:return A(Z+"Seconds",2);case l:return A(Z+"Milliseconds",3);default:return this.clone()}},h.endOf=function(u){return this.startOf(u,!1)},h.$set=function(u,y){var c,$=v.p(u),p="set"+(this.$u?"UTC":""),S=(c={},c[w]=p+"Date",c[z]=p+"Date",c[Y]=p+"Month",c[O]=p+"FullYear",c[d]=p+"Hours",c[m]=p+"Minutes",c[l]=p+"Seconds",c[s]=p+"Milliseconds",c)[$],A=$===w?this.$D+(y-this.$W):y;if($===Y||$===O){var j=this.clone().set(z,1);j.$d[S](A),j.init(),this.$d=j.set(z,Math.min(this.$D,j.daysInMonth())).$d}else S&&this.$d[S](A);return this.init(),this},h.set=function(u,y){return this.clone().$set(u,y)},h.get=function(u){return this[v.p(u)]()},h.add=function(u,y){var c,$=this;u=Number(u);var p=v.p(y),S=function(R){var B=D($);return v.w(B.date(B.date()+Math.round(R*u)),$)};if(p===Y)return this.set(Y,this.$M+u);if(p===O)return this.set(O,this.$y+u);if(p===w)return S(1);if(p===H)return S(7);var A=(c={},c[m]=n,c[d]=i,c[l]=e,c)[p]||1,j=this.$d.getTime()+u*A;return v.w(j,this)},h.subtract=function(u,y){return this.add(-1*u,y)},h.format=function(u){var y=this,c=this.$locale();if(!this.isValid())return c.invalidDate||f;var $=u||"YYYY-MM-DDTHH:mm:ssZ",p=v.z(this),S=this.$H,A=this.$m,j=this.$M,R=c.weekdays,B=c.months,Z=function(N,J,pt,at){return N&&(N[J]||N(y,$))||pt[J].slice(0,at)},rt=function(N){return v.s(S%12||12,N,"0")},nt=c.meridiem||function(N,J,pt){var at=N<12?"AM":"PM";return pt?at.toLowerCase():at},X={YY:String(this.$y).slice(-2),YYYY:this.$y,M:j+1,MM:v.s(j+1,2,"0"),MMM:Z(c.monthsShort,j,B,3),MMMM:Z(B,j),D:this.$D,DD:v.s(this.$D,2,"0"),d:String(this.$W),dd:Z(c.weekdaysMin,this.$W,R,2),ddd:Z(c.weekdaysShort,this.$W,R,3),dddd:R[this.$W],H:String(S),HH:v.s(S,2,"0"),h:rt(1),hh:rt(2),a:nt(S,A,!0),A:nt(S,A,!1),m:String(A),mm:v.s(A,2,"0"),s:String(this.$s),ss:v.s(this.$s,2,"0"),SSS:v.s(this.$ms,3,"0"),Z:p};return $.replace(_,function(N,J){return J||X[N]||p.replace(":","")})},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(u,y,c){var $,p=v.p(y),S=D(u),A=(S.utcOffset()-this.utcOffset())*n,j=this-S,R=v.m(this,S);return R=($={},$[O]=R/12,$[Y]=R,$[I]=R/3,$[H]=(j-A)/6048e5,$[w]=(j-A)/864e5,$[d]=j/i,$[m]=j/n,$[l]=j/e,$)[p]||j,c?R:v.a(R)},h.daysInMonth=function(){return this.endOf(Y).$D},h.$locale=function(){return q[this.$L]},h.locale=function(u,y){if(!u)return this.$L;var c=this.clone(),$=F(u,y,!0);return $&&(c.$L=$),c},h.clone=function(){return v.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},b}(),xt=Q.prototype;return D.prototype=xt,[["$ms",s],["$s",l],["$m",m],["$H",d],["$W",w],["$M",Y],["$y",O],["$D",z]].forEach(function(b){xt[b[1]]=function(h){return this.$g(h,b[0],b[1])}}),D.extend=function(b,h){return b.$i||(b(h,Q,D),b.$i=!0),D},D.locale=F,D.isDayjs=L,D.unix=function(b){return D(1e3*b)},D.en=q[C],D.Ls=q,D.p={},D})})(wt);var P=wt.exports,St={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(ft,function(){var e="minute",n=/[+-]\d\d(?::?\d\d)?/g,i=/([+-]|\d\d)/g;return function(s,l,m){var d=l.prototype;m.utc=function(f){var T={date:f,utc:!0,args:arguments};return new l(T)},d.utc=function(f){var T=m(this.toDate(),{locale:this.$L,utc:!0});return f?T.add(this.utcOffset(),e):T},d.local=function(){return m(this.toDate(),{locale:this.$L,utc:!1})};var w=d.parse;d.parse=function(f){f.utc&&(this.$u=!0),this.$utils().u(f.$offset)||(this.$offset=f.$offset),w.call(this,f)};var H=d.init;d.init=function(){if(this.$u){var f=this.$d;this.$y=f.getUTCFullYear(),this.$M=f.getUTCMonth(),this.$D=f.getUTCDate(),this.$W=f.getUTCDay(),this.$H=f.getUTCHours(),this.$m=f.getUTCMinutes(),this.$s=f.getUTCSeconds(),this.$ms=f.getUTCMilliseconds()}else H.call(this)};var Y=d.utcOffset;d.utcOffset=function(f,T){var _=this.$utils().u;if(_(f))return this.$u?0:_(this.$offset)?Y.call(this):this.$offset;if(typeof f=="string"&&(f=function(C){C===void 0&&(C="");var q=C.match(n);if(!q)return null;var L=(""+q[0]).match(i)||["-",0,0],F=L[0],D=60*+L[1]+ +L[2];return D===0?0:F==="+"?D:-D}(f),f===null))return this;var M=Math.abs(f)<=16?60*f:f,E=this;if(T)return E.$offset=M,E.$u=f===0,E;if(f!==0){var V=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(E=this.local().add(M+V,e)).$offset=M,E.$x.$localOffset=V}else E=this.utc();return E};var I=d.format;d.format=function(f){var T=f||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return I.call(this,T)},d.valueOf=function(){var f=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*f},d.isUTC=function(){return!!this.$u},d.toISOString=function(){return this.toDate().toISOString()},d.toString=function(){return this.toDate().toUTCString()};var O=d.toDate;d.toDate=function(f){return f==="s"&&this.$offset?m(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():O.call(this)};var z=d.diff;d.diff=function(f,T,_){if(f&&this.$u===f.$u)return z.call(this,f,T,_);var M=this.local(),E=m(f).local();return z.call(M,E,T,_)}}})})(St);var Tt=St.exports,Dt={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(ft,function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},n={};return function(i,s,l){var m,d=function(I,O,z){z===void 0&&(z={});var f=new Date(I),T=function(_,M){M===void 0&&(M={});var E=M.timeZoneName||"short",V=_+"|"+E,C=n[V];return C||(C=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:_,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:E}),n[V]=C),C}(O,z);return T.formatToParts(f)},w=function(I,O){for(var z=d(I,O),f=[],T=0;T<z.length;T+=1){var _=z[T],M=_.type,E=_.value,V=e[M];V>=0&&(f[V]=parseInt(E,10))}var C=f[3],q=C===24?0:C,L=f[0]+"-"+f[1]+"-"+f[2]+" "+q+":"+f[4]+":"+f[5]+":000",F=+I;return(l.utc(L).valueOf()-(F-=F%1e3))/6e4},H=s.prototype;H.tz=function(I,O){I===void 0&&(I=m);var z=this.utcOffset(),f=this.toDate(),T=f.toLocaleString("en-US",{timeZone:I}),_=Math.round((f-new Date(T))/1e3/60),M=l(T).$set("millisecond",this.$ms).utcOffset(15*-Math.round(f.getTimezoneOffset()/15)-_,!0);if(O){var E=M.utcOffset();M=M.add(z-E,"minute")}return M.$x.$timezone=I,M},H.offsetName=function(I){var O=this.$x.$timezone||l.tz.guess(),z=d(this.valueOf(),O,{timeZoneName:I}).find(function(f){return f.type.toLowerCase()==="timezonename"});return z&&z.value};var Y=H.startOf;H.startOf=function(I,O){if(!this.$x||!this.$x.$timezone)return Y.call(this,I,O);var z=l(this.format("YYYY-MM-DD HH:mm:ss:SSS"));return Y.call(z,I,O).tz(this.$x.$timezone,!0)},l.tz=function(I,O,z){var f=z&&O,T=z||O||m,_=w(+l(),T);if(typeof I!="string")return l(I).tz(T);var M=function(q,L,F){var D=q-60*L*1e3,v=w(D,F);if(L===v)return[D,L];var Q=w(D-=60*(v-L)*1e3,F);return v===Q?[D,v]:[q-60*Math.min(v,Q)*1e3,Math.max(v,Q)]}(l.utc(I,f).valueOf(),_,T),E=M[0],V=M[1],C=l(E).utcOffset(V);return C.$x.$timezone=T,C},l.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},l.tz.setDefault=function(I){m=I}}})})(Dt);var zt=Dt.exports;P.extend(Tt),P.extend(zt);class It extends x{constructor({after:e=null,before:n=null}={}){super();g(this,"after");g(this,"before");this.after=e,this.before=n}normalize(){this.constructor.ensureTimezoneIsSet();let e=null,n=null;return k.default(this.after)||(e=P.tz(this.after,this.constructor.userTimezone).hour(0).minute(0).second(0).tz("UTC").format("YYYY-MM-DD[T]HH:mm:ss[Z]")),k.default(this.before)||(n=P.tz(this.before,this.constructor.userTimezone).hour(0).minute(0).second(0).add(1,"day").subtract(1,"second").tz("UTC").format("YYYY-MM-DD[T]HH:mm:ss[Z]")),{after:e,before:n}}async denormalize(e){this.constructor.ensureTimezoneIsSet(),this.after=null,this.before=null,k.default(e.after)||(this.after=P.tz(e.after,"UTC").tz(this.constructor.userTimezone).hour(0).minute(0).second(0).format("YYYY-MM-DD")),k.default(e.before)||(this.before=P.tz(e.before,"UTC").tz(this.constructor.userTimezone).hour(0).minute(0).second(0).add(1,"day").subtract(1,"second").format("YYYY-MM-DD"))}static ensureTimezoneIsSet(){var e;this.constructor.userTimezone=(e=this.constructor.userTimezone)!=null?e:P.tz.guess()||"UTC"}}g(It,"userTimezone"),P.extend(Tt),P.extend(zt);class Ot extends x{constructor({after:e=null,before:n=null}={}){super();g(this,"after");g(this,"before");this.after=e,this.before=n}normalize(){this.constructor.ensureTimezoneIsSet();let e=null,n=null;return k.default(this.after)||(e=P.tz(this.after,this.constructor.userTimezone).tz("UTC").format("YYYY-MM-DD[T]HH:mm:ss[Z]")),k.default(this.before)||(n=P.tz(this.before,this.constructor.userTimezone).tz("UTC").format("YYYY-MM-DD[T]HH:mm:ss[Z]")),{after:e,before:n}}async denormalize(e){this.constructor.ensureTimezoneIsSet(),this.after=null,this.before=null,k.default(e.after)||(this.after=P.tz(e.after,"UTC").tz(this.constructor.userTimezone).format("YYYY-MM-DD[T]HH:mm:ss[Z]")),k.default(e.before)||(this.before=P.tz(e.before,"UTC").tz(this.constructor.userTimezone).format("YYYY-MM-DD[T]HH:mm:ss[Z]"))}static ensureTimezoneIsSet(){var e;this.constructor.userTimezone=(e=this.constructor.userTimezone)!=null?e:P.tz.guess()||"UTC"}}g(Ot,"userTimezone");function oe(r){return r==null?!0:typeof r=="string"?r.trim().length===0:typeof r=="function"||Array.isArray(r)?r.length===0:r instanceof Object?Object.keys(r).length===0:!1}function ht(r){if(!(r instanceof Object))return r;if(Array.isArray(r))return r.map(ht);const t={...r};return Object.keys(t).forEach(e=>{t[e]instanceof Object&&(t[e]=ht(t[e])),oe(t[e])&&delete t[e]}),t}class ae{constructor(t={}){g(this,"_filters",[]);if(!(t instanceof Object))throw Error("A FilterCollection expects an object.");Object.keys(t).forEach(e=>{if(!(t[e]instanceof x))throw Error(`Filter ${e} doesn't extend the Filter class.`);this[e]=t[e],this._filters.push(e)})}normalize(){const t={};return this._filters.forEach(e=>{const n=this[e];t[e]=n.normalize()}),ht(t)}async denormalize(t){const e=[];for(const n of this._filters){const i=this[n];i instanceof x&&typeof t[n]!="undefined"&&e.push(i.denormalize(t[n]))}return e.length>0&&await Promise.all(e),this}}async function ue(r={},t={preserveQuery:!1,targetRoute:void 0}){if(typeof r!="function")throw Error("initialState should be provided as a function.");const e=ut.useRoute(),n=ut.useRouter(),i=o.ref(r());async function s(w){Object.assign(o.unref(i),await o.unref(i).denormalize(w.query))}function l(){i.value=G(r())}function m(w={}){const H={};return t.preserveQuery===!0&&Object.assign(H,e.query),Object.assign(H,o.unref(i).normalize(),w)}async function d(w={}){var Y;const H=(Y=o.unref(t.targetRoute))!=null?Y:e;await n.push(Object.assign({...H},{query:m(w)}))}return ut.onBeforeRouteUpdate(w=>s(w)),await s(e),{filters:i,buildQueryParams:m,submit:d,clear:l}}const ce=async({state:r={},methods:t={},name:e="store"}={})=>{r=o.reactive(r);const n={name:e,state:r,...Object.keys(t).reduce(function(i,s){const l=t[s];return i[s]=function(){return l(r,...arguments)},i},{}),async use(i){return await i.install(this),this}};return n.install=i=>i.provide(e,{...n,state:o.readonly(r)}),n},lt=(r="store")=>o.inject(r);class Mt{constructor(t){Object.keys(t).forEach(e=>{this[e]=new it(t[e])})}for(t){if(typeof t=="string"&&Object.keys(this).includes(t))return this[t];if(!Object.keys(this).includes(t["@type"]))throw Error(`Endpoint not found for item ${t["@type"]}.`);return this[t["@type"]]}}class it{constructor(t){g(this,"endpoint");this.endpoint=t}toString(){return this.endpoint}toJSON(){return this.endpoint}buildIri(t){let e=new tt.URI(this.endpoint);return e=e.withPath(`${e.getPath()}/${t}`),e.toString()}withQuery(t){const e=new tt.URI(this.endpoint),n=new tt.QueryString(e).withParams(t);return new it(e.withQuery(n.toString()).toString())}paginated(t){if(t=o.unref(t),t===!1)return this.withQuery({pagination:0});const e={pagination:1};return t&&(e.itemsPerPage=t),this.withQuery(e)}synchronize(t=window.location.href){return this.withQuery(new tt.QueryString(new tt.URI(t)).getParams())}}const fe=(r,t)=>lt(t).state.endpoints[r];function st(r){return r=o.unref(r),r==null?!1:Object.keys(r).includes("@id")&&r["@id"]!=null}function U(r){return r=o.unref(r),r===null?null:typeof r=="string"?r:(ot(r),r["@id"])}function Et(r){const t=U(r);return t.substring(t.lastIndexOf("/")+1)}function he(r){return r.map(U)}function le(r){return r.map(Et)}function ot(r,t=null){if(typeof r!="object"||!("@id"in r))throw Error("Invalid item.");if(t!==null){if(typeof t=="string"&&t!==r["@type"])throw Error(`Expected item of type "${t}", got "${r["@type"]}".`);if(Array.isArray(t)&&t.includes(r["@type"])===!1)throw Error(`Expected item of any "${t.join("|")}", got "${r["@type"]}".`)}}function K(r,t){return U(r)===U(t)}function jt(r,t){if(r=o.unref(r),r=Array.from(r).map(o.unref),t=o.unref(t),Array.isArray(t)){const e=t;for(const n of e)if(jt(r,n))return!0;return!1}for(const e of r)if(K(e,t))return!0;return!1}function de(r,t){const e=r.findIndex(n=>K(n,t));return e>=0&&r.splice(e,1),r}function dt(r,t){const e=r.find(n=>K(n,t));return typeof e=="undefined"?null:e}function me(r,t){return r.findIndex(e=>K(e,t))}function ye(r,t){return r.filter(e=>e["@type"]===t)}function ge(r){Object.assign(r,r.map(t=>U(t)))}function pe(r,t){return r=o.unref(r),ot(r),Object.assign({"@id":r["@id"],"@type":r["@type"]},t)}class mt extends Error{constructor(){super(...arguments);g(this,"statusCode")}get title(){return this["hydra:title"]}get description(){return this["hydra:description"]}}class Ct{constructor(){g(this,"id");g(this,"propertyPath");g(this,"message");g(this,"code");this.id=Bt.v4()}}class At extends mt{constructor(e){super();g(this,"_violations",[]);Object.assign(this,{*[Symbol.iterator](){yield*this.violations}}),Object.assign(this,e)}get violations(){return this._violations}set violations(e){this._violations=e.map(n=>Object.assign(new Ct,n))}getPropertyPaths(){return[...new Set(this.violations.map(({propertyPath:e})=>e))]}getViolations(e){const n=Array.from(arguments);return n.length===0?this.violations:k.default(n[0])?this.violations.filter(i=>k.default(i.propertyPath)):this.violations.filter(i=>e===i.propertyPath)}}class Yt{constructor(t={}){Object.assign(this,{...t,*[Symbol.iterator](){yield*this["hydra:member"]||[]}})}get length(){return this.items.length}get totalItems(){return this["hydra:totalItems"]||0}get items(){return this["hydra:member"]||[]}forEach(t){return(this["hydra:member"]||[]).forEach(t)}map(t){return(this["hydra:member"]||[]).map(t)}filter(t){return(this["hydra:member"]||[]).filter(t)}find(t){return(this["hydra:member"]||[]).find(t)}findIndex(t){return(this["hydra:member"]||[]).findIndex(t)}}function $e(r){if(typeof r!="object"||r==null)throw Error("Invalid object.");return Object.keys(r).forEach(t=>delete r[t]),r}function yt(r,t){return r=$e(r),Object.assign(r,t)}function be(r){const t=lt(),e=o.ref(o.unref(r)),n=o.reactive(G(o.unref(r))),i=o.computed(()=>!st(o.unref(n))),s=o.ref(!1);o.watch(e,w=>yt(n,w));const l=o.computed(()=>JSON.stringify(o.unref(n))!==JSON.stringify(o.unref(e)));return{item:n,isUnsavedDraft:l,isCreationMode:i,isSubmitting:s,reset:()=>yt(n,G(o.unref(r))),submit:async()=>{try{s.value=!0;const w=await t.upsertItem(n);return e.value=w,yt(n,G(w)),w}finally{s.value=!1}}}}function ve(){const r=i=>{i=o.unref(i),i.querySelectorAll("[name]").forEach(function(s){s.setCustomValidity("")})},t=(i,s=!0)=>{i=o.unref(i);const l=i.checkValidity();return!l&&s&&i.reportValidity(),l},e=(i,s)=>{r(i),Array.from(s).forEach(l=>n(i,l)),t(i)},n=(i,{propertyPath:s,message:l})=>{var m;i=o.unref(i),(m=i.querySelector(`[name='${s}']`))==null||m.setCustomValidity(l)};return{resetValidity:r,bindViolations:e,validate:t}}let gt;const we=1,Se=2;class _t{constructor(t,e){g(this,"readyState",we);g(this,"url");g(this,"withCredentials");var n;this.url=t,this.withCredentials=(n=e==null?void 0:e.withCredentials)!=null?n:!1,setTimeout(()=>this.onopen(),10)}onerror(){}onmessage(){}onopen(){}close(){this.readyState=Se}triggerEvent(t){this.onmessage(t)}triggerError(t){this.onerror(t)}}(()=>{var r;return typeof process!="undefined"&&((r=process==null?void 0:process.env)==null?void 0:r.NODE_ENV)==="test"||"test"===void 0})()?gt=_t:gt=window.EventSource;var Te=gt;const De=(r,t)=>{const e=new Ht(r,t);return Object.assign(e,{install(n){n.provide("mercure",e)}})},Ut=()=>o.inject("mercure");function ze(r,t){return r.length===t.length&&r.every(e=>t.includes(e))}class Ht{constructor(t,e={}){g(this,"hub");g(this,"options");g(this,"connection");g(this,"subscribedTopics");g(this,"endpoint");g(this,"emitter");g(this,"lastEventId");Object.assign(this,{hub:t,options:o.reactive(e)}),this.lastEventId=o.ref(),this.subscribedTopics=o.ref([]),this.endpoint=o.computed(()=>{const n=new URL(this.hub),i=o.unref(this.subscribedTopics);return i.includes("*")?n.searchParams.append("topic","*"):i.forEach(s=>n.searchParams.append("topic",s)),o.unref(this.lastEventId)&&n.searchParams.append("Last-Event-ID",o.unref(this.lastEventId)),n.toString()}),this.emitter=Xt.default()}subscribe(t=["*"],e=!0){Array.isArray(t)||(t=[t]);const n=Array.from(o.unref(this.subscribedTopics)),i=[...new Set([...o.unref(this.subscribedTopics),...t])];this.subscribedTopics.value=i,e&&!ze(n,i)&&this.listen()}unsubscribe(t){Array.isArray(t)||(t=[t]),this.subscribedTopics.value=this.subscribedTopics.value.filter(e=>!t.includes(e)),this.connection&&this.listen()}addListener(t){return this.emitter.on("message",t)}removeListener(t){return this.emitter.off("message",t)}listen(){if(o.unref(this.subscribedTopics).length===0){this.stop();return}this.connection||this.connect()}connect(){this.stop(),this.connection=new Te(o.unref(this.endpoint),this.options),this.connection.onopen=()=>this.emitter.emit("open",{endpoint:o.unref(this.endpoint)}),this.connection.onmessage=t=>(this.lastEventId.value=t.lastEventId,this.emitter.emit("message",t)),this.connection.onerror=t=>{this.emitter.emit("error",t),typeof this.options.reconnectInterval=="number"&&(this.stop(),setTimeout(()=>this.connect(),this.options.reconnectInterval))}}stop(){var t;(t=this.connection)==null||t.close(),this.connection=void 0}}const Rt=(r,t)=>Object.assign(t,r),qt=()=>{};function Pt(r,t,e=["*"],n=Rt,i=qt){Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);const s=l=>{try{const m=JSON.parse(l.data);if(!st(m))return;if(Object.keys(m).length===1){i(U(m));return}for(const d of t)K(U(m),d)&&n(m,o.unref(d))}catch(m){console.debug(m)}};return r.addListener(s),r.subscribe(e),s}const Lt=(r,t,e)=>{Array.isArray(t)||(t=[t]);const n=i=>{try{const s=JSON.parse(i.data);for(const l of t)if(typeof te.default(l).fromUri(U(s))!="undefined"){e(s);break}}catch{}};return r.addListener(n),r.subscribe(t),n},Ie=r=>{r=r!=null?r:Ut();const t=[];return o.onUnmounted(()=>{for(const n of t)r.removeListener(n)}),{synchronize:(n,i=["*"],s=Rt,l=qt)=>{t.push(Pt(r,n,i,s,l))},on(n,i){const s=Lt(r,n,i);return t.push(s),s}}},Oe={"hydra:Collection":Yt,"hydra:Error":mt,ConstraintViolationList:At},Nt=async(r,t)=>{const e=o.ref(!1),n=Gt.asyncComputed(r,t,{evaluating:e});return new Promise(i=>{o.watch(e,s=>{s===!1&&i(n)})})};class Vt{constructor(){Object.assign(this,{*[Symbol.iterator](){yield*Object.values(this)}})}get length(){return Array.from(this).length}forEach(t){return Array.from(this).forEach(t)}map(t){return Array.from(this).map(t)}filter(t){return Array.from(this).filter(t)}find(t){return Array.from(this).find(t)}findIndex(t){return Array.from(this).findIndex(t)}}const Me=function(r){throw r};class Ee{constructor(t,e={}){g(this,"api");g(this,"endpoints");g(this,"classmap");var s;this.api=t;const{endpoints:n,classmap:i}=e;this.endpoints=new Mt(n!=null?n:{}),this.classmap={...Oe,...i},this.errorHandler=(s=e.errorHandler)!=null?s:Me}factory(t,e){var n;for(const i in this.classmap)if(i===((n=t["@type"])!=null?n:t)){const s=this.classmap[i];return t instanceof s?t:(t=Object.assign(new s,t),e&&Object.assign(t,{statusCode:e}),o.reactive(t))}return t}storeItem({state:t},e){const n=U(e);return Object.keys(t.items).includes(n)?Object.assign(t.items[n],e):t.items[n]=o.ref(e),t.items[n]}removeItem({state:t},e){const n=U(e);delete t.items[n]}async clearItems({state:t}){t.items=o.reactive(new Vt)}async handle(t,{errorHandler:e=this.errorHandler}={}){var n,i,s,l,m;try{const{data:d}=await t();return this.factory(d)}catch(d){typeof((n=d.response)==null?void 0:n.data)=="object"&&((i=d.response)==null?void 0:i.data)!=null&&(d=this.factory(d.response.data,(s=d.response)==null?void 0:s.status)),d.statusCode=(m=d.statusCode)!=null?m:(l=d.response)==null?void 0:l.status,e(d)}}async fetchItem({state:t},e,n){const i=U(e),s=await this.handle(()=>this.api.get(i,n),n);return this.storeItem({state:t},this.factory(s))}async getItem({state:t},e,n){if(e===null)return null;const i=U(e),s=dt(t.items,i);if(s!=null)return s;if(typeof e=="object"){const l=this.factory(e);return this.storeItem({state:t},l)}return await this.fetchItem({state:t},i,n)}async fetchCollection({state:t},e,n){const i=await this.handle(()=>this.api.get(e,n),n);i["hydra:member"]=i["hydra:member"].map(l=>this.factory(l));const s=this.factory(i);return s["hydra:member"]=s["hydra:member"].map(l=>this.factory(l)),s}async createItem({state:t},e,n){const i=this.endpoints.for(e);return e=await this.handle(()=>this.api.post(i,e,n),n),this.storeItem({state:t},e)}async updateItem({state:t},e,n){return ot(e),e=await this.handle(()=>this.api.put(U(e),e,n),n),this.storeItem({state:t},e)}async upsertItem({state:t},e,n){return st(e)?this.updateItem({state:t},e,n):this.createItem({state:t},e,n)}async deleteItem({state:t},e,n){const i=U(e);await this.handle(()=>this.api.delete(i,n),n),e=dt(t.items,i),e!==null&&this.removeItem({state:t},e)}async getRelation({state:t},e,n){return e===null?null:typeof e=="object"?e:typeof e=="function"?Nt(()=>this.getRelation({state:t},e(),n)):await this.getItem({state:t},e,n)}async getRelations({state:t},e,n){return typeof e=="function"?Nt(()=>this.getRelations({state:t},e(),n),[]):Promise.all(e.map(i=>this.getRelation({state:t},i,n)))}async install(t){t.state.items=o.reactive(new Vt),t.state.endpoints=o.readonly(this.endpoints),t.state.classmap=o.readonly(this.classmap),t.storeItem=e=>this.storeItem(t,e),t.removeItem=e=>this.removeItem(t,e),t.clearItems=()=>this.clearItems(t),t.getItem=(e,n)=>this.getItem(t,e,n),t.fetchItem=(e,n)=>this.fetchItem(t,e,n),t.fetchCollection=(e,n)=>this.fetchCollection(t,e,n),t.createItem=(e,n)=>this.createItem(t,e,n),t.updateItem=(e,n)=>this.updateItem(t,e,n),t.upsertItem=(e,n)=>this.upsertItem(t,e,n),t.deleteItem=(e,n)=>this.deleteItem(t,e,n),t.getRelation=(e,n)=>this.getRelation(t,e,n),t.getRelations=(e,n)=>this.getRelations(t,e,n),t.endpoint=e=>t.state.endpoints[e],t.getItemsByType=e=>t.state.items.filter(n=>e===n["@type"])}}function Ft(r){if(typeof r=="string")return r;try{return U(r)}catch{return null}}function je(r){return r.map(t=>Ft(t))}async function kt(r,t){try{return await t.getItem(r)}catch{return null}}async function Ce(r,t){return Promise.all(r.map(e=>kt(e,t)))}class Ae extends x{constructor(e,{store:n,multiple:i=!1}){super();g(this,"items",[]);g(this,"multiple");g(this,"store");this.items=Array.isArray(e)?e:[e],this.store=n,this.multiple=i}get item(){var e;return(e=this.items[0])!=null?e:null}set item(e){this.items=[e],this.multiple=!1}normalize(){return this.multiple||this.items.length>1?je(this.items):Ft(this.item)}async denormalize(e){if(Array.isArray(e)){this.items=await Ce(e,this.store);return}this.items=[await kt(e,this.store)]}}const Ye={asc:"desc",desc:"asc"};class _e extends x{constructor(e={}){super();g(this,"order");this.order=e}revert(){var n;const e={};for(const i in this.order){const s=this.order[i];e[i]=(n=Ye[s])!=null?n:s}return this.order=e,this}normalize(){return this.order}async denormalize(e){this.order={},typeof e=="object"&&e!=null&&(this.order=e)}}class Ue extends x{constructor(e=null){super();g(this,"value");this.value=e}normalize(){var e;return[void 0,null,""].includes((e=this.value)==null?void 0:e.trim())?null:this.value.trim()}async denormalize(e){if(typeof e=="string"&&(e=e.trim()),[void 0,null,""].includes(e)){this.value=null;return}this.value=e}}class He extends x{constructor(e=!1){super();g(this,"value");this.value=e}normalize(){return this.value?"true":"false"}async denormalize(e){if(e==null){this.value=!1;return}e=`${e}`.trim(),this.value=["true","on","yes","1"].includes(e.toLowerCase())}}class Re{constructor(){g(this,"fields");g(this,"preload")}get headers(){var e,n,i,s,l;const t={};return((n=(e=this.preload)==null?void 0:e.length)!=null?n:0)!==0&&(t.preload=[...new Set(this.preload)].map(m=>`"${m}"`).join(", ")),((s=(i=this.fields)==null?void 0:i.length)!=null?s:0)!==0&&(t.fields=[...new Set([...this.fields,...(l=this.preload)!=null?l:[]])].map(m=>`"${m}"`).join(", ")),t}}function qe({fields:r,preload:t}={}){return Object.assign(new Re,{fields:r},{preload:t}).headers}a.ApiClient=re,a.ArrayFilter=se,a.ConstraintViolationList=At,a.DateRangeFilter=It,a.DatetimeRangeFilter=Ot,a.FakeEventSource=_t,a.FilterCollection=ae,a.HttpError=bt,a.HydraCollection=Yt,a.HydraEndpoint=it,a.HydraEndpoints=Mt,a.HydraError=mt,a.HydraPlugin=Ee,a.ItemFilter=Ae,a.Mercure=Ht,a.OrderFilter=_e,a.TextFilter=Ue,a.TruthyFilter=He,a.Violation=Ct,a.areSameIris=K,a.checkValidItem=ot,a.clone=G,a.containsIri=jt,a.createMercure=De,a.createStore=ce,a.getId=Et,a.getIds=le,a.getIri=U,a.getIris=he,a.getItemByIri=dt,a.getItemIndexByIri=me,a.getItemsByType=ye,a.hasIri=st,a.mercureSync=Pt,a.normalizeIris=ge,a.on=Lt,a.partialItem=pe,a.useEndpoint=fe,a.useFilters=ue,a.useFormValidation=ve,a.useItemForm=be,a.useMercure=Ut,a.useMercureSync=Ie,a.useStore=lt,a.vulcain=qe,a.withoutDuplicates=ie,a.withoutIri=de,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
